
<head-div-dir
	caption ="Посты"
	filter  ="mpCtrl.f"
	show    ="mpCtrl.showAddPost">
</head-div-dir>

<hr>
<a id="addPost"></a>
<div class="row well" ng-if="mpCtrl.showAddPost">	
	<div class="col-xs-2" >
		<!-- spinner -->
		<my-spinner ng-if="mpCtrl.showSpinner"></my-spinner>
	</div>
	<form name="npForm" class="col-xs-10" ng-submit="mpCtrl.addPost()">
		<div class="row input-group">
			<!-- <input ng-model="mpCtrl.npUrl" name="npUrl" required class="form-control" placeholder="URL или ID нового поста..."> -->
			<input ng-model="mpCtrl.npName" name="np" required class="form-control" placeholder="Название нового поста...">
			<span class="input-group-btn">
				<button type="submit" ng-disabled="npForm.$invalid" class="btn btn-primary" title="Сохранить данные поста">Сохранить</button>
			</span>
		</div><br>
		<div class="row">
			<textarea ng-model="mpCtrl.npCaption" name="npCaption"  class="form-control" placeholder="Текст нового поста..."></textarea>
		</div><br>
		<div class="row">
			<div class="col-xs-6">
				<label>Опубликовать
					<input type="checkbox" ng-model="mpCtrl.published">
				</label>
			</div>	
			<div class="col-xs-6 text-right">
				<label for="selectTags">Катагирии поста:</label><br>
				<select 
					ng-model="mpCtrl.sel" required 
					ng-options="tagK as tagV.name for (tagK, tagV) in mpCtrl.tags"
					class="form-control"
					id="selectTags">
				</select>
			</div>
		</div>
		
	</form>	
</div>


<a id="allPosts"></a>
<div class="row" ng-if="!mpCtrl.showAddPost">
	<div class="col-xs-8">
		<button class="btn" ng-click=mpCtrl.loadData()>Ещё...</button>
	</div>
	<div class="col-xs-4  text-right" ng-if="mpCtrl.isShowTagF">
		<select 
			ng-model="mpCtrl.tagF"
			ng-options="tagK as tagV.name for (tagK, tagV) in mpCtrl.tags"
			ng-change="mpCtrl.changeF()"
			class="form-control"
			id='tagF'>
		</select>
	</div>
</div>
<hr>

<div class="row" ng-if="mpCtrl.showList()">
	<table class="table table-hover">
		<thead>
			<tr class="row">
				<th class="col-xs-1">Дата:</th>
				<th class="col-xs-1">Опубл.:</th>
				<th class="col-xs-5">Пост:</th>
				<th class="col-xs-2">
					Tag: <button class="btn" ng-class="{'btn-default' : !mpCtrl.showCatF}" title="Отфильтровать посты по категориям" ng-click="mpCtrl.showTagF()">
					<span class="glyphicon glyphicon-filter" aria-hidden="true" ></span>
				</button>
			</th>
			<th class="col-xs-2">Действия:</th>
		</tr>
	</thead>
	<tbody>
		<tr ng-repeat="p in mpCtrl.posts | filter:mpCtrl.f | orderBy:'-date'" class="row">
			<td><small>{{p.date | date:'dd.MM.yy  HH:mm'}}</small></td>
			<td>
				<span class="glyphicon glyphicon-ok" aria-hidden="true" ng-show="{{p.published}}"></span>
			</td>
			<td><a ui-sref="posts.item({item : p.$id})" ng-click="mpCtrl.clickPostRef()"><b>{{p.name}}</b> <i>({{p.text}})</i></a></td>
			<td>{{p.tagId}}</td>
			<td>

			</td>
		</tr>
	</tbody>	
</table>

<p ng-if="mpCtrl.showInfo" class="text-right"><sub><i>Нажмите на страницу для получения детальной информации... </i></sub></p>
</div>

<div ui-view></div>
